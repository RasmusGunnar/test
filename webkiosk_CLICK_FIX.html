<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Webkiosk – CLICK FIX v2</title>
<meta name="theme-color" content="#0f172a" />

<style>
  :root{ --bg:#f6f7f9; --panel:#ffffff; --fg:#0f172a; --muted:#6b7280; --border:#e6e8ec; --accent:#0f172a; --radius:20px; --shadow:0 10px 30px rgba(2,6,23,.06); --logoH:clamp(44px,8vw,64px); --logoBoxMin:120px; --logoBoxMax:clamp(140px,24vw,200px); }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:var(--bg);color:var(--fg);display:flex;min-height:100vh;position:relative}
  .wrap{width:min(1200px,100%);padding:clamp(12px,2vw,24px);margin:auto;position:relative;z-index:1}
  .grid{display:grid;gap:clamp(12px,2vw,18px);grid-template-columns:repeat(12,1fr)}
  .panel{background:var(--panel);border:1px solid var(--border);border-radius:20px;box-shadow:var(--shadow)}
  .widget{padding:clamp(16px,2.2vw,24px)}
  .widget h2{margin:0 0 6px;font-size:clamp(15px,1.6vw,18px);color:var(--muted);font-weight:600}
  .clock-time{font-size:clamp(40px,6vw,56px);line-height:1;font-weight:750}
  .clock-date{margin-top:6px;font-size:clamp(14px,1.8vw,18px);color:var(--muted)}
  .weather-main{display:flex;align-items:center;gap:14px}
  .weather-temp{font-size:clamp(40px,6vw,56px);font-weight:750}
  .weather-line{font-size:clamp(14px,1.8vw,18px);color:var(--muted)}
  .icon{width:clamp(34px,4.5vw,48px);height:clamp(34px,4.5vw,48px);color:var(--accent)}

  .tiles{grid-column:1/-1;display:grid;gap:clamp(12px,2vw,18px);grid-template-columns:repeat(3,1fr)}
  .tile{min-height:140px;padding:clamp(16px,2.4vw,24px);display:grid;grid-template-columns:minmax(0,1fr) minmax(var(--logoBoxMin),var(--logoBoxMax));align-items:center;gap:clamp(12px,2vw,20px);cursor:pointer;user-select:none;transition:transform .12s,box-shadow .12s}
  .tile:hover{transform:translateY(-1px);box-shadow:0 14px 30px rgba(2,6,23,.10)}
  .meta .label{font-size:clamp(18px,2.2vw,22px);font-weight:750}
  .meta .sub{color:var(--muted);font-size:clamp(12px,1.8vw,15px);margin-top:6px}
  .logo-box{height:var(--logoH);display:flex;align-items:center;justify-content:flex-end;width:100%;max-width:var(--logoBoxMax)}
  .logo-box img{width:100%;height:100%;max-height:100%;object-fit:contain;display:block}

  .widget.weather{grid-column:span 6}
  .widget.clock{grid-column:span 6}
  @media (max-width:900px){.widget.weather,.widget.clock{grid-column:span 12}.tiles{grid-template-columns:1fr}}

  /* Overlays – ALDRIG klikbare når skjult */
  .calendar-view,.wk-panel,.modal{display:none;pointer-events:none}
  .calendar-view.visible,.wk-panel.visible,.modal.visible{display:block;pointer-events:auto}

  .calendar-view{position:fixed;inset:0;padding:clamp(12px,2vw,20px);background:rgba(246,247,249,.92);backdrop-filter:blur(8px);z-index:60}
  .calendar-inner{height:100%;display:flex;flex-direction:column;gap:12px}
  .topbar{display:flex;align-items:center;gap:12px}
  .back-btn{display:inline-flex;align-items:center;gap:10px;padding:10px 14px;border-radius:12px;background:#fff;border:1px solid var(--border);color:#0f172a;cursor:pointer;font-weight:650;box-shadow:var(--shadow)}
  .calframe.panel{flex:1;min-height:0;overflow:hidden;display:flex}
  iframe{width:100%;height:100%;border:0;display:block}

  .fab{position:fixed;right:20px;bottom:20px;z-index:90}
  .fab button{width:56px;height:56px;border-radius:50%;border:1px solid var(--border);background:#fff;color:#0f172a;display:inline-flex;align-items:center;justify-content:center;box-shadow:var(--shadow);cursor:pointer}

  .wk-panel{position:fixed;inset:0;background:#00000010;backdrop-filter:saturate(1.1) blur(4px);z-index:80}
  .wk-shell{position:absolute;inset:0;background:#fff;box-shadow:0 12px 60px rgba(2,6,23,.25)}
  .wk-topbar{position:absolute;left:0;right:0;top:0;height:52px;display:flex;align-items:center;gap:10px;padding:0 12px;border-bottom:1px solid var(--border);background:linear-gradient(#fff,#fafafa);z-index:2}
  .wk-topbar .btn{border:1px solid var(--border);border-radius:10px;background:#fff;padding:8px 10px;cursor:pointer}
  .wk-iframe{position:absolute;top:52px;left:0;right:0;bottom:0}

  /* Klik-test knap (øverst ALTID) */
  #clickTest{position:fixed;left:12px;top:12px;z-index:2147483647;background:#0f172a;color:#fff;border:0;border-radius:10px;padding:8px 10px;cursor:pointer}

  /* Synk badge – ikke essentiel for klik, men beholdt */
  .sync-badge{position:fixed;left:12px;bottom:12px;z-index:95;background:#fff;border:1px solid #e6e8ec;border-radius:14px;padding:8px 12px;font:13px/1.2 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;box-shadow:0 8px 24px rgba(2,6,23,.08);display:flex;gap:8px;align-items:center;color:#0f172a}
  .sync-badge .dot{width:10px;height:10px;border-radius:50%;display:inline-block}
  .sync-online .dot{background:#10b981}
  .sync-offline .dot{background:#9ca3af}
</style>
</head>
<body>
  <button id="clickTest" onclick="alert('Klik virker ✓')">Klik test</button>

  <div class="wrap" id="appRoot">
    <div class="grid">
      <section class="panel widget weather" aria-label="Vejr">
        <h2>Vejr</h2>
        <div class="weather-main">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M3 16.5a4.5 4.5 0 0 1 4.5-4.5h.5A6.5 6.5 0 1 1 20 14.5a3.5 3.5 0 0 1-3.5 3.5H8.5A5.5 5.5 0 0 1 3 16.5z"/>
          </svg>
          <div>
            <div class="weather-temp" id="weatherTemp">--°</div>
            <div class="weather-line" id="weatherCond">-</div>
            <div class="weather-line" id="weatherCity">-</div>
          </div>
        </div>
      </section>

      <section class="panel widget clock" aria-label="Ur">
        <h2>Ur</h2>
        <div class="clock-time" id="clockTime">--:--</div>
        <div class="clock-date" id="clockDate">--</div>
      </section>

      <div class="tiles">
        <button class="panel tile" id="tileCalendar" type="button"
                onclick="window.__handlers && window.__handlers.openCalendar()">
          <div class="meta"><div class="label">Kalender</div><div class="sub">Familieoversigt</div></div>
          <div class="logo-box"><img id="logoCalendar" alt="" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='64'%3E%3Crect width='160' height='64' fill='%23f0f2f5'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='14' fill='%236b7280' font-family='Inter,Arial'%3EKalender%3C/text%3E%3C/svg%3E"></div>
        </button>

        <button class="panel tile" id="tileHomey" type="button"
                onclick="window.__handlers && window.__handlers.openHomey()">
          <div class="meta"><div class="label">Homey</div><div class="sub">Dashboard</div></div>
          <div class="logo-box"><img id="logoHomey" alt="" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='64'%3E%3Crect width='160' height='64' fill='%23f0f2f5'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='14' fill='%236b7280' font-family='Inter,Arial'%3EHomey%3C/text%3E%3C/svg%3E"></div>
        </button>

        <button class="panel tile" id="tileSonos" type="button"
                onclick="window.__handlers && window.__handlers.openSonos()">
          <div class="meta"><div class="label">Sonos</div><div class="sub">App eller web</div></div>
          <div class="logo-box"><img id="logoSonos" alt="" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='64'%3E%3Crect width='160' height='64' fill='%23f0f2f5'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='14' fill='%236b7280' font-family='Inter,Arial'%3ESonos%3C/text%3E%3C/svg%3E"></div>
        </button>
      </div>
    </div>
  </div>

  <!-- Kalender overlay -->
  <section class="calendar-view" id="calendarView" aria-hidden="true">
    <div class="calendar-inner">
      <div class="topbar"><button class="back-btn" id="closeCalendar" type="button" onclick="document.getElementById('calendarView').classList.remove('visible');document.getElementById('calendarView').setAttribute('aria-hidden','true');">⬅ Tilbage</button></div>
      <div class="calframe panel"><iframe id="calendarFrame" title="Kalender"></iframe></div>
    </div>
  </section>

  <!-- Tandhjul -->
  <div class="fab" aria-live="polite">
    <button id="openSettings" title="Indstillinger" aria-label="Indstillinger" type="button"
            onclick="document.getElementById('settingsModal').classList.add('visible');document.getElementById('settingsModal').setAttribute('aria-hidden','false');">
      <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0  0 0-1 1.51V21a2 2 0  1 1-4 0v-.09a1.65 1.65 0  0 0-1-1.51 1.65 1.65 0  0 0-1.82.33l-.06.06a2 2 0  1 1-2.83-2.83l.06-.06a1.65 1.65 0  0 0 .33-1.82 1.65 1.65 0  0 0-1.51-1H3a2 2 0  1 1 0-4h.09a1.65 1.65 0  0 0 1.51-1 1.65 1.65 0  0  0-.33-1.82l-.06-.06a2 2 0  1 1 2.83-2.83l.06.06a1.65 1.65 0  0 0 1.82.33H9a1.65 1.65 0  0 0 1-1.51V3a2 2 0  1 1 4 0v.09a1.65 1.65 0  0 0 1 1.51 1.65 1.65 0  0 0 1.82-.33l.06.06a2 2 0  1 1 2.83 2.83l-.06.06a1.65 1.65 0  0 0-.33 1.82V9c0 .66.26 1.3.73 1.77.47.47 1.11.73 1.77.73h.09a2 2 0  1 1 0 4h-.09a1.65 1.65 0  0 0-1.51 1Z"/>
      </svg>
    </button>
  </div>

  <!-- Indstillinger modal -->
  <div class="modal" id="settingsModal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
    <div class="dialog" onclick="event.stopPropagation()">
      <h3 id="settingsTitle">Indstillinger</h3>
      <p style="margin:0 0 10px;color:#6b7280">Denne rebuild er til klik-test. Funktioner kan tilføjes når klik er bekræftet.</p>
      <div class="actions">
        <button class="btn" type="button" onclick="document.getElementById('settingsModal').classList.remove('visible');document.getElementById('settingsModal').setAttribute('aria-hidden','true');">Luk</button>
      </div>
    </div>
  </div>

  <!-- Webpanel overlay -->
  <div id="wkPanel" class="wk-panel" aria-hidden="true">
    <div class="wk-shell">
      <div class="wk-topbar">
        <button id="wkBack" class="btn" type="button" onclick="document.getElementById('wkPanel').classList.remove('visible');document.getElementById('wkPanel').setAttribute('aria-hidden','true');">← Tilbage</button>
        <div id="wkTitle" class="title">Indlæser…</div>
      </div>
      <iframe id="wkFrame" class="wk-iframe"></iframe>
    </div>
  </div>

  <!-- Sync badge (visuelt – ikke vigtigt for klik) -->
  <div id="syncBadge" class="sync-badge sync-offline" aria-live="polite"><span class="dot"></span><span>Offline</span></div>

<script>
// 1) Klik-diagnose – vis hvad der ligger øverst under cursor ved hvert klik
document.addEventListener('click', function(ev){
  try{
    const el = document.elementFromPoint(ev.clientX, ev.clientY);
    console.log('[CLICK]', 'top=', el && (el.id || el.className || el.tagName));
  }catch(_){}
}, true);

// 2) Ur (hurtig)
function updateClock(){
  const t=document.getElementById('clockTime'), d=document.getElementById('clockDate');
  const now=new Date();
  t.textContent=now.toLocaleTimeString('da-DK',{hour:'2-digit',minute:'2-digit'});
  const dd=now.toLocaleDateString('da-DK',{weekday:'long',day:'2-digit',month:'long'});
  d.textContent=dd.charAt(0).toUpperCase()+dd.slice(1);
}
setInterval(updateClock,1000); updateClock();

// 3) Handlers (både addEventListener OG inline fallback peger her)
window.__handlers = {
  openCalendar: function(){
    const v=document.getElementById('calendarView');
    const f=document.getElementById('calendarFrame');
    f.src='https://example.com/'; // midlertidig test-url
    v.classList.add('visible'); v.setAttribute('aria-hidden','false');
  },
  openHomey: function(){
    const p=document.getElementById('wkPanel'), f=document.getElementById('wkFrame'), t=document.getElementById('wkTitle');
    t.textContent='Homey (test)'; f.src='https://my.homey.app/'; p.classList.add('visible'); p.setAttribute('aria-hidden','false');
  },
  openSonos: function(){
    const p=document.getElementById('wkPanel'), f=document.getElementById('wkFrame'), t=document.getElementById('wkTitle');
    t.textContent='Sonos (test)'; f.src='https://play.sonos.com'; p.classList.add('visible'); p.setAttribute('aria-hidden','false');
  }
};

// 4) Dobbelt-binding via JS (ud over inline)
['tileCalendar','tileHomey','tileSonos'].forEach(function(id){
  const el=document.getElementById(id);
  if(!el) return;
  el.addEventListener('click', function(){
    if(id==='tileCalendar') window.__handlers.openCalendar();
    if(id==='tileHomey')    window.__handlers.openHomey();
    if(id==='tileSonos')    window.__handlers.openSonos();
  }, false);
});

// 5) Sikr at ALT skjult overlay er ude af vejen ved load
window.addEventListener('DOMContentLoaded', function(){
  ['calendarView','wkPanel','settingsModal'].forEach(function(id){
    const el=document.getElementById(id);
    if(el){ el.classList.remove('visible'); el.setAttribute('aria-hidden','true'); el.style.display='none'; el.offsetHeight; el.style.display=''; }
  });
});

// 6) Ingen service worker, ingen manifest → ingen cache/overlay-problemer.
</script>
</body>
</html>
